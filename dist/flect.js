!function(){"use strict";let t,i=0;class s extends HTMLElement{static t=new DOMParser;static clone=function(t){return s.t.parseFromString(t,"text/html").body};constructor(){super(),this.i=!0,this.h={},this.l=this.l||{},this.o=this.o||!1,this.custom={},this.hasAttribute("noinit")||this.init()}init(){this.u(),this.m(),this.p()}ref(t){return this.h[t]?this.h[t][0]:void 0}refs(t){return this.h[t]}v(t){return t.split(".")}P(t){let i=this.l;for(let s of t)if(i=i[s],void 0===i)break;return i}m(){this.l.body=[].slice.call(this.childNodes),this.l.html=this.innerHTML,this.l.text=this.textContent;for(let t of this.attributes)if("x"!==t.name[0]||"-"!==t.name[1])if("datas-"===t.name.substring(0,6)){let i=t.name.substring(6),s=JSON.parse(t.value);this.l[i]=s}else this.l[t.name]=t.value}u(){this.D={M:{},effect(t,i,s,e){this.M[t]||(this.M[t]=new Map),this.M[t].get(i)||this.M[t].set(i,[]),this.M[t].get(i).push(s),void 0!==e&&s(e,i)},clear(t,i){i?this.M[t].delete(i):delete this.M[t]},set(t,i,s){if(t[i]=s,this.M[i])for(let[t,e]of this.M[i])for(let i of e)i(s,t);return!0}},this.datas=new Proxy(this.l,this.D)}$(t){return(t.O?"!":"")+t.join(".")}g(t,i){this.h[t]||(this.h[t]=[]),this.h[t].push(i)}p(){this.k.S.call(this,this.datas,this.A.bind(this),this.j.bind(this))}A(e){if(!e)return;if(!this.k.C&&(this.k.C=s.clone(e),this.k.style)){let s=function(s){t||(t=document.createElement("style"),t.id="x-scoped-stylesheet",document.head.appendChild(t));let e="x"+i++,h=`[style-ref="${e}"]`;return t.textContent+=s(h),e}(this.k.style),e=this.k.C.querySelectorAll(":scope > *");for(let t of e)t.setAttribute("style-ref",s)}this.H=this.k.C.cloneNode(!0),this.J(this.H);const h=this.H.childNodes;for(let t of h)t.o=this.o;this.replaceWith(...h)}j(t){if(!this.k.style&&this.k.C)throw"You should render style before DOM !";this.k.style||(this.k.style=t)}effect(t,i){this.D.effect(t,this,i,this.l[t])}L(t,i,s){let e=t.querySelectorAll("*");for(let t of e)for(let e of t.attributes)if("x"===e.name[0]&&"-"===e.name[1]){let h=this.v(e.value);h[0]===i&&(h[0]=s,t.setAttribute(e.name,this.$(h)))}}N(t){t.R||(t.component=this,t.R=!0,"X"===t.tagName[0]&&"-"===t.tagName[1]?this.T(t):this.X(t))}Y(t){this.N(t),this.J(t)}J(t){let i=t.querySelectorAll(":scope > *");for(let t of i)this.Y(t)}T(t){for(let i of t.attributes)if("x"===i.name[0]&&"-"===i.name[1]){let s=i.name.substring(2),e=this.v(i.value),h=()=>{t.datas[s]=this.P(e)};t.l||(t.l={}),this.D.effect(e[0],t,h),t.l[s]=this.P(e)}else"ref"===i.name&&this.g(i.value,t)}X(t){for(let i=0,e=0;i<t.attributes.length;i++,e++){let e=t.attributes[i],h=!0;if("x"===e.name[0]&&"-"===e.name[1]){let i=e.name.substring(2),h=this.v(e.value),l=()=>{t.setAttribute(i,this.P(h))};if("text"===i)l=()=>{t.textContent=this.P(h)};else if("html"===i)l=()=>{t.innerHTML=this.P(h)};else if("append"===i)l=()=>{let i=this.P(h);i&&(i.length?t.append(...i):t.append(i))};else if("prepend"===i)l=()=>{let i=this.P(h);i&&(i.length?t.prepend(...i):t.prepend(i))};else if("toggle"===i)l=()=>{let i=this.P(h);t.classList.toggle(i,i)};else if("show"===i)l=()=>{this.P(h)?t.style.removeProperty("display"):t.style.display="none"};else if("if"===i||"unless"===i)t.q||(t.q=document.createElement("div"),this.J(t)),l=()=>{let s=this.P(h),e=t.childNodes.length;"if"===i?s&&!e?this.B(t.q,t):!s&&e&&this.B(t,t.q):"unless"===i&&(s&&e?this.B(t,t.q):s||e||this.B(t.q,t))};else if("for"===i){const i=e.value,r=t.getAttribute("var");t.F||(t.F=[],t.G=0,t.I=t.innerHTML,t.innerHTML=""),l=()=>{let e=this.P(h);if(void 0===e)return;let l="number"==typeof e?e:e.length,f=l-t.G;if(f>0){for(let e=0;e<t.G+f&&e<l;e++)if(e>=t.G){if(!t.F[e]){let h=s.clone(t.I);this.L(h,r,i+"."+e),h.childNodes.forEach((t=>{t.o=e})),this.J(h),t.F.push(h)}this.B(t.F[e],t)}}else if(f<0)for(let i=t.G-1;i>=0;i--)if(i>t.G-1+f)for(;t.childNodes.length;){let s=t.childNodes[t.childNodes.length-1];if(s.o!==i)break;t.F[i].prepend(s)}t.G+=f}}this.D.effect(h[0],t,l,this.l[h[0]])}else"ref"===e.name?this.g(e.value,t):h=!1;h&&(t.removeAttribute(e.name),i--)}}B(t,i){for(;t.childNodes.length;){let s=t.childNodes[0];i.appendChild(s)}}}customElements.define("x-element-prototype-factory",s),window.define=function(t,i){let e=`x${t}Element`;if(window[e])throw`Element x-${t} is already defined !`;if(!i)throw`Element x-${t} need a render function !`;return window[e]=class extends s{constructor(){super()}static name=t;static S=i;static C=!1;static style=!1},window[e].prototype.k=window[e],customElements.define(`x-${t}`,window[e]),window[e]}}();
