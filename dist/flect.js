var Flect=function(){"use strict";const t=(t,n,s,o)=>{const r=n.t=n.t||new e;r[o]=s(t),n.addEventListener(o,r)};class e{o(t){this[t.type](t)}}const n={l(t){let e=this;e.i=e.i||t||{},e.u=new Set},h(){this.p()},m(t,e){let n=this;for(const s of e){const e=t[s.index];s.$&&(e.g=s,n.u.add(e));for(const[t,o]of s.v){const s=o._(n.i,e,o.k,t);s&&n.u.add(s)}!s.$&&s.j&&n.m(e.children,s.j)}},p(){for(const t of this.u)t.h();this.u.clear()}};function s(t){this.l(t)}s.prototype=n;let o=null;const r=t=>{const e=function(t){if(void 0!==t){e.data=t;for(const t of e.C)t()}else o&&(e.C.add(o),o.F.add(e.C));return e.data};return e.data=t,e.M=!0,e.C=new Set,e},c=t=>{const e=o;return o=t,o.F=new Set,o.h=(t=>()=>{for(const e of t.F)e.delete(t)})(o),t(),o=e,t},l=document,i=t=>l.createElement(t),f=(t,e)=>t.cloneNode(e);let u=l.createComment(""),a=i("template"),h=l.createDocumentFragment();const d=t=>{let e=f(h);return e.append(...t),e},x=()=>{},p=(t,...e)=>t.reduce(((n,s,o)=>n+(s+(o===t.length-1?"":e[o]))),""),w=i("style"),m="css-x";let y=1;const $=(t,e)=>"$"+(e||y)+t,b=(t,...e)=>{if("string"==typeof t)return`${m}="${$(t,y)}"`;{const n=p(t,e);w.textContent+=n,w.parentElement||l.head.appendChild(w)}},g=(t,e,n)=>{const s=n,o=t.component.O;e.setAttribute(m,$(s,o))},v=(t,e,n)=>{const s=n,o=t.ref(s);let r=!0;return c((()=>{const t=o.S();if(r){for(const n of t)n(e);r=!1}else t[t.length-1](e)}))},E=(t,e,n)=>{const s=e.style.display;return c((()=>{n(t)?s?e.style.display=s:e.style.removeProperty("display"):e.style.display="none"}))},_=(t,e,n)=>c((()=>e.textContent=n(t))),k=(t,e,n,s)=>c((()=>e.setAttribute(s,n(t)))),j=t=>{switch(t.name){case"x-text":return _;case"x-show":return E;case"x-ref":return v;case"x-css":return g;default:return k}},C=(t,e,n,s)=>(e.i=e.i||{},c((()=>{const o=e.i[s],c=n(t);o&&o.M?o(c):e.i[s]=r(c)}))),F={},M=t=>{if(F[t])return F[t];let e=Object.getPrototypeOf((function(){})).constructor,n=/^[\n\s]*if.*\(.*\)/.test(t.trim())||/^(let|const)\s/.test(t.trim())?`(()=>{ ${t} })()`:t;let s=(()=>{try{let s=new e(["scope"],`with(scope){return ${n}};`);return Object.defineProperty(s,"name",{value:`FlectExpression ${t}`}),s}catch(e){return console.error("FlectExpression error : "+t,e),!1}})();return F[t]=s,s},O=t=>0===t.name.indexOf("x-on:"),S=t=>0===t.tagName.indexOf("X-"),H=t=>!!t.content,L=(t,e,n)=>{let s=[];const o=[{H:T()}],r=e.getAttribute("key")||"item";return e.h=()=>{for(let t=1;t<o.length;t++)o[t].L.h()},e.replaceWith(o[0].H),c((()=>{const c=n(t);!function(t,e,n,s,o,r){const c=e.g;let l=0;const i=n.length,u=s.length;let a=u-i;for(;l<i&&l<u;)n[l]!==s[l]&&o[l+1].T(s[l]),l++;const h=[],d=o[l].H;for(;a>0;){let e;const n=f(c.U,!0);(e=o[l+1])?e.T(s[l]):e=o[l+1]=U(t,r,s[l]),h.push(n,e.H),c.j&&e.L.m(n.children,c.j),a--,l++}h.length&&d.replaceWith(d,...h);for(;a<0;){let t=o[l].H.nextSibling;const e=o[l+1].H;for(;t!==e;){const e=t;t=t.nextSibling,e.remove()}o[l+1].L.h(),a++,l++}}(t,e,s,c,o,r),s=c}))};const T=()=>f(u),U=(t,e,n)=>{const o=T(),c=r(n);return{H:o,T:c,L:new s({...t,[e]:c})}},X=t=>{switch(t.name){case"x-for":return L;case"x-if":return}},q=e=>{const n=[];for(let s=0;s<e.length;s++){let o=e[s];const r=H(o),c=r||S(o),l={index:s,j:!1,U:!1,$:c,v:new Map};let i=o.attributes.length;for(;i--;){const e=o.attributes[i];if(0===e.name.indexOf("x-")){const n=O(e),s=n?e.name.substring(5):e.name.substring(2),i={k:e.value&&("ref"===s||"css"===s?e.value:M(e.value)),_:r?X(e):c?C:n?t:j(e)};l.v.set(s,i),o.removeAttribute(e.name)}}(o.content||o).childNodes.length&&(c&&(o=l.U=o.content||d(o.childNodes)),l.j=q(o.children)),(l.j||l.v.size)&&n.push(l)}return n.length>0&&n};class z extends HTMLElement{constructor(){super(),this.l(),this.X={}}onMount(){}connectedCallback(){let t=this;for(const e of t.attributes)t.i[e.name]=e.value;t.i.component=t,t.i.ref=t.q,t.onMount(t.i),t.A()}onUnmount(){}h(){let t=this;t.onUnmount(t.i),t.p()}A(){let t=this;const e=t.g||t.B;let n=e.U,s=e.j,o=t.B.O;const c=r,l=n?x:p,i=o?x:b,u=t.B.D.call(t.i,c,l,i);u&&(n||(n="string"==typeof u?e.U=(t=>{let e=f(a);return e.innerHTML=t,e.content})(u):d(u),s=e.j=q(n.children))),t.O=t.B.O=o||y++,e.U&&(n=f(n,!0)),s&&t.m(n.children,s),t.replaceWith(n)}q(t,e){const n=this.component.X[t]||(this.component.X[t]=(()=>{const t=[];return t.S=r([]),t})());if(!e)return n;n.push(e),n.S(n)}}Object.assign(z.prototype,n);const A={};return{define:(t,e)=>{const n=`__flect_${t}__`;if(window[n])throw`customElement x-${t} is already defined !`;return A[n]=class extends z{constructor(){super()}},A[n].D=e,A[n].prototype.B=A[n],customElements.define(`x-${t}`,A[n]),A[n]},signal:r}}();
