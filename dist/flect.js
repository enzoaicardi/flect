var Flect=function(t){"use strict";let e=new DOMParser;function i(t){return"X-FOR"===t.tagName||"X-IF"===t.tagName}function s(t){return"x"===t[0]&&"-"===t[1]}function n(t){switch(t){case"x-text":return r;case"x-html":return l;case"x-show":return f;default:return h}}function r(t,e,i){e.textContent=this.t(i)}function l(t,e,i){e.innerHTML=this.t(i)}function f(t,e,i){let s=e.style.display;this.t(i)?e.style.display="none":s?e.style.display=s:e.style.removeProperty("display")}function h(t,e,i){e.setAttribute(i.i,this.t(i))}function o(t,e,i){}function u(t,e,i){}let c=/\{[a-zA-Z0-9_.$!?|-]+\}/g;function a(t,e={}){let i={l:"!"===t[0],h:("!"===t[0]?t.substring(1):t).split(".").map((t=>t.split("|")))},s=e[function(t,e=0){return t.h[e][0]}(i)];var n,r;return s&&s.ref.push((n=s.path,(r=i).h.unshift(...n.h),r.h[n.h.length])),i}function d(t,e){let i={datas:{},o:t},s=t.match(c);if(s)for(let t of s)i.datas[t]=a(t.substring(1,t.length-1),e);else i.datas[t]=a(t,e);return i}function p(t,e={}){let r,l={type:t.tagName,datas:{},children:{},u:{}};if(i(t)){let i=t.getAttribute("key"),s=t.getAttribute("var");if(s){let n=a(s,e),f=function(t){switch(t){case"X-IF":return o;case"X-FOR":return u;default:throw"Undefined"}}(t.tagName);if(i){let t=l.u[i]=[];e[i]={path:n,ref:t}}r=l,r.action=t.tagName,r.datas[n.h[0][0]]=[[f,n]]}}else for(let i=0;i<t.attributes.length;i++){let f=t.attributes[i],h=f.name,o=f.value;if(s(h)){let s=d(o,e);s.i=h.substring(2);let f=n(h),u=s.datas;r||(r=l);for(let t in u){let e=u[t].h[0][0];r.datas[e]||(r.datas[e]=[]),r.datas[e].push([f,s])}t.removeAttribute(h),i--}}if("X"!==(f=t).tagName[0]||"-"!==f.tagName[1]||i(t)){let i=t.children;for(let t=0;t<i.length;t++){let s=p(i[t],e);s&&(r||(r=l),r.children[t]=s)}}var f;return r}function x(t,e){return t.datas[t.o]?this.getData(t.datas[t.o],e):t.o.replace(c,(i=>this.getData(t.datas[i],e)))}function m(t,e=this.p){for(let i=0;i<t.h.length&&e;i++){let s=t.h[i];e=e[s[0]];for(let t=1;t<s.length;t++)e=this.filters[s[t]](e)}return t.l?!e:e}class w extends HTMLElement{constructor(){super()}m(){this.p=this.datas||{},!this.v||Object.assign(this.p,this.v),this.g(),this.F(),this.init(this.datas),this.O(),this.X()}filters={};M={};init(){}g(){let t=this.p;t.body=this.childNodes;for(let e of this.attributes){let i=e.name;if("datas-"===i.substring(0,6)){let s=JSON.parse(e.value);t[i.substring(6)]=s}else t[i]=e.value}}F(){var t;this.D={P:t=this,M:{},mapping:new Map,effect(t,e,i){let s=this.M,n=this.mapping;s[t]||(s[t]=new Map),s[t].get(e)||(s[t].set(e,[]),n.get(e)||n.set(e,[])),s[t].get(e).push(...i),n.get(e).push(t)},clone(t,e){for(let i of this.mapping.get(t))this.M[i].set(e,this.M[i].get(t))},remove(t){for(let e of this.mapping.get(t))this.M[e].delete(t)},R(e,i){let s=this.M;if(s[e])for(let[n,r]of s[e])for(let[e,s]of r)e.call(t,i,n,s)},set(t,e,i){return t[e]=i,this.R(e,i),!0}},this.datas=new Proxy(this.p,this.D);for(let t in this.M)this.D.effect(t,this,[[this.M[t]]])}O(){}X(){let t=this.k;if(!t.C){let s=this.I();"string"==typeof s?t.C=(i=s,e.parseFromString(i,"text/html").body):this.C=s,t.S=p(t.C)}var i;this.C||(this.C=t.C.cloneNode(!0)),!t.S||this.$(this.C,t.S),console.log(t.S),this.replaceWith(...this.C.childNodes)}$(t,e){let i=e.children;for(let s in i){let n=i[s],r=t.children[s],l=n.datas;for(let t in l){this.D.effect(t,r,l[t]);for(let[e,i]of l[t])e.call(this,null,r,i)}e.action||this.$(r,n)}}t=x;getData=m}let y={},v=w;return t.define=function(t,e){if(y[t])throw`Component x-${t} is already defined !`;e.prototype.k=e,customElements.define("x-"+t,e)},t.x=v,t}({});
